{"version":3,"names":[],"sources":["src/PNotifyMobile.svelte"],"sourcesContent":["<script context=\"module\">\n  export const position = 'PrependContainer';\n  export const defaults = {\n    // Let the user swipe the notice away.\n    swipeDismiss: true\n  };\n</script>\n<svelte:window on:resize={() => windowInnerWidth = window.innerWidth} />\n<script>\n  import { onMount, onDestroy } from 'svelte';\n\n  // The PNotify notice.\n  export let self = null;\n\n  export let swipeDismiss = defaults.swipeDismiss;\n\n  let origXY = null;\n  let diffXY = null;\n  let noticeWidthHeight = null;\n  let noticeOpacity = null;\n  let csspos = 'left';\n  let direction = 'X';\n  let span = 'Width';\n  let windowInnerWidth = window.innerWidth;\n  let offs = [];\n\n  $: {\n    const stack = self.stack;\n    if (stack) {\n      if (windowInnerWidth <= 480) {\n        if (!('_m_spacing1' in stack)) {\n          stack._m_spacing1 = stack.spacing1;\n          stack._m_firstpos1 = stack.firstpos1;\n          stack._m_spacing2 = stack.spacing2;\n          stack._m_firstpos2 = stack.firstpos2;\n          stack.spacing1 = 0;\n          stack.firstpos1 = 0;\n          stack.spacing2 = 0;\n          stack.firstpos2 = 0;\n          stack.queuePosition();\n        }\n      } else {\n        if ('_m_spacing1' in stack) {\n          stack.spacing1 = stack._m_spacing1;\n          delete stack._m_spacing1;\n          stack.firstpos1 = stack._m_firstpos1;\n          delete stack._m_firstpos1;\n          stack.spacing2 = stack._m_spacing2;\n          delete stack._m_spacing2;\n          stack.firstpos2 = stack._m_firstpos2;\n          delete stack._m_firstpos2;\n          stack.queuePosition();\n        }\n      }\n    }\n  }\n\n  onMount(() => {\n    offs = [\n      self.on('touchstart', e => {\n        if (!swipeDismiss) {\n          return;\n        }\n\n        const stack = self.stack;\n        if (stack) {\n          switch (stack.dir1) {\n            case 'up':\n            case 'down':\n              csspos = 'left';\n              direction = 'X';\n              span = 'Width';\n              break;\n            case 'left':\n            case 'right':\n              csspos = 'top';\n              direction = 'Y';\n              span = 'Height';\n              break;\n          }\n        }\n\n        origXY = e.touches[0]['screen' + direction];\n        noticeWidthHeight = self.refs.elem['scroll' + span];\n        noticeOpacity = window.getComputedStyle(self.refs.elem)['opacity'];\n        self.refs.container.style[csspos] = 0;\n      }),\n\n      self.on('touchmove', e => {\n        if (!origXY || !swipeDismiss) {\n          return;\n        }\n\n        const curXY = e.touches[0]['screen' + direction];\n\n        diffXY = curXY - origXY;\n        const opacity = (1 - (Math.abs(diffXY) / noticeWidthHeight)) * noticeOpacity;\n\n        self.refs.elem.style.opacity = opacity;\n        self.refs.container.style[csspos] = diffXY + 'px';\n      }),\n\n      self.on('touchend', () => {\n        if (!origXY || !swipeDismiss) {\n          return;\n        }\n\n        self.refs.container.classList.add('pnotify-mobile-animate-left');\n        if (Math.abs(diffXY) > 40) {\n          const goLeft = (diffXY < 0) ? noticeWidthHeight * -2 : noticeWidthHeight * 2;\n          self.refs.elem.style.opacity = 0;\n          self.refs.container.style[csspos] = goLeft + 'px';\n          self.close();\n        } else {\n          self.refs.elem.style.removeProperty('opacity');\n          self.refs.container.style.removeProperty(csspos);\n        }\n        origXY = null;\n        diffXY = null;\n        noticeWidthHeight = null;\n        noticeOpacity = null;\n      }),\n\n      self.on('touchcancel', () => {\n        if (!origXY || !swipeDismiss) {\n          return;\n        }\n\n        self.refs.elem.style.removeProperty('opacity');\n        self.refs.container.style.removeProperty(csspos);\n        origXY = null;\n        diffXY = null;\n        noticeWidthHeight = null;\n        noticeOpacity = null;\n      }),\n\n      self.on('pnotify:afterClose', () => {\n        // Remove any styling we added to close it.\n        if (!swipeDismiss) {\n          return;\n        }\n\n        self.refs.elem.style.removeProperty('opacity');\n        self.refs.container.style.removeProperty('left');\n        self.refs.container.style.removeProperty('top');\n      })\n    ];\n  });\n\n  onDestroy(() => {\n    offs.forEach(off => off());\n  });\n</script>\n<style>\n  :global([data-pnotify] .pnotify-container) {\n    position: relative;\n  }\n  :global([data-pnotify] .pnotify-mobile-animate-left) {\n    transition: left .1s ease;\n  }\n  :global([data-pnotify] .pnotify-mobile-animate-top) {\n    transition: top .1s ease;\n  }\n  @media (max-width: 480px) {\n    /* -- Notice */\n    :global([data-pnotify].pnotify) {\n      font-size: 1.2em;\n      -webkit-font-smoothing: antialiased;\n      -moz-font-smoothing: antialiased;\n      -ms-font-smoothing: antialiased;\n      font-smoothing: antialiased;\n    }\n    :global(body > [data-pnotify].pnotify) {\n      position: fixed;\n    }\n    :global([data-pnotify].pnotify.pnotify-stack-down),\n    :global([data-pnotify].pnotify.pnotify-stack-up) {\n      width: 100% !important;\n    }\n    :global([data-pnotify].pnotify.pnotify-stack-right),\n    :global([data-pnotify].pnotify.pnotify-stack-left) {\n      height: 100% !important;\n    }\n    :global([data-pnotify].pnotify .pnotify-shadow) {\n      -webkit-box-shadow: none;\n      -moz-box-shadow: none;\n      box-shadow: none;\n    }\n    :global([data-pnotify].pnotify.pnotify-stack-down .pnotify-shadow) {\n      border-bottom-width: 5px;\n    }\n    :global([data-pnotify].pnotify.pnotify-stack-up .pnotify-shadow) {\n      border-top-width: 5px;\n    }\n    :global([data-pnotify].pnotify.pnotify-stack-right .pnotify-shadow) {\n      border-right-width: 5px;\n    }\n    :global([data-pnotify].pnotify.pnotify-stack-left .pnotify-shadow) {\n      border-left-width: 5px;\n    }\n    :global([data-pnotify].pnotify .pnotify-container) {\n      -webkit-border-radius: 0;\n      -moz-border-radius: 0;\n      border-radius: 0;\n    }\n    :global([data-pnotify].pnotify.pnotify-stack-down .pnotify-container),\n    :global([data-pnotify].pnotify.pnotify-stack-up .pnotify-container) {\n      width: auto !important;\n    }\n    :global([data-pnotify].pnotify.pnotify-stack-right .pnotify-container),\n    :global([data-pnotify].pnotify.pnotify-stack-left .pnotify-container) {\n      height: 100% !important;\n    }\n  }\n</style>\n"],"mappings":"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"}