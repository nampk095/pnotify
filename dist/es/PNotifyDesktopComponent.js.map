{"version":3,"names":[],"sources":["src/PNotifyDesktopComponent.html"],"sourcesContent":["<script context=\"module\">\n  import PNotify from './PNotifyCore';\n\n  export const key = 'Desktop';\n\n  export const defaults = {\n    // Display the notification as a desktop notification.\n    desktop: false,\n    // If desktop notifications are not supported or allowed, fall back to a regular notice.\n    fallback: true,\n    // The URL of the icon to display. If false, no icon will show. If null, a default icon will show.\n    icon: null,\n    // Using a tag lets you update an existing notice, or keep from duplicating notices between tabs.\n    // If you leave tag null, one will be generated, facilitating the 'update' function.\n    // see: http://www.w3.org/TR/notifications/#tags-example\n    tag: null,\n    // Optionally display a different title for the desktop.\n    title: null,\n    // Optionally display different text for the desktop.\n    text: null,\n    // Any additional options to be passed to the Notification constructor.\n    options: {}\n  };\n\n  export function requestPermission () {\n    if (typeof Notification !== 'undefined' && 'requestPermission' in Notification) {\n      Notification.requestPermission();\n    } else if ('webkitNotifications' in window) {\n      window.webkitNotifications.requestPermission();\n    }\n  }\n\n  const Notification = window.Notification;\n\n  let notify = (title, options, onclick, onclose) => {\n    // Memoize based on feature detection.\n    if ('Notification' in window) {\n      notify = (title, options, onclick, onclose) => {\n        const notice = new Notification(title, options);\n        if ('NotificationEvent' in window) {\n          notice.addEventListener('notificationclick', onclick);\n          notice.addEventListener('close', onclose);\n        } else if ('addEventListener' in notice) {\n          notice.addEventListener('click', onclick);\n          notice.addEventListener('close', onclose);\n        } else {\n          notice.onclick = onclick;\n          notice.onclose = onclose;\n        }\n        return notice;\n      };\n    } else if ('mozNotification' in navigator) {\n      notify = (title, options, onclick, onclose) => {\n        // Gecko < 22\n        const notice = navigator.mozNotification\n          .createNotification(title, options.body, options.icon)\n          .show();\n        notice.onclick = onclick;\n        notice.onclose = onclose;\n        return notice;\n      };\n    } else if ('webkitNotifications' in window) {\n      notify = (title, options, onclick, onclose) => {\n        const notice = window.webkitNotifications.createNotification(\n          options.icon,\n          title,\n          options.body\n        );\n        notice.onclick = onclick;\n        notice.onclose = onclose;\n        return notice;\n      };\n    } else {\n      notify = (title, options, onclick, onclose) => {\n        return null;\n      };\n    }\n    return notify(title, options, onclick, onclose);\n  };\n\n  function checkPermission () {\n    if (typeof Notification !== 'undefined' && 'permission' in Notification) {\n      return (Notification.permission === 'granted');\n    } else if ('webkitNotifications' in window) {\n      return window.webkitNotifications.checkPermission() == 0; // eslint-disable-line eqeqeq\n    }\n    return false;\n  }\n\n  let _permission = checkPermission();\n</script>\n<script>\n  // The PNotify notice.\n  export let _notice = null;\n\n  export let desktop = defaults.desktop;\n  export let fallback = defaults.fallback;\n  export let icon = defaults.icon;\n  export let tag = defaults.tag;\n  export let title = defaults.title;\n  export let text = defaults.text;\n  export let options = defaults.options;\n\n  let _desktop;\n  let _oldAnimation;\n  let _icon;\n  let _tag;\n\n  $: _disabled = (!_permission && fallback) || !desktop;\n  $: {\n    if (_notice.animation !== 'none') {\n      _oldAnimation = _notice.animation;\n    }\n\n    // This is necessary so desktop notices don't cause spacing problems\n    // when positioning.\n    if (_notice.getAnimatingClass() !== '' && !_disabled) {\n      _notice.setAnimatingClass('');\n    }\n\n    if (_disabled && _notice.hasModuleClass('ui-pnotify-desktop-hide')) {\n      _notice.removeModuleClass('ui-pnotify-desktop-hide');\n      _notice.animation = _oldAnimation;\n    } else if (!_disabled && !_notice.hasModuleClass('ui-pnotify-desktop-hide')) {\n      _notice.addModuleClass('ui-pnotify-desktop-hide');\n      _notice.animation = 'none';\n      genNotice();\n    }\n  }\n\n  export function init () {\n    // Animation should always be 'none' for desktop notices, but remember\n    // the old animation so it can be recovered.\n    _oldAnimation = _notice.animation;\n\n    if (!desktop) {\n      return;\n    }\n\n    _permission = checkPermission();\n\n    if (!_permission) {\n      // Keep the notice from opening if fallback is false.\n      if (!fallback) {\n        _notice.autoOpen = false;\n      }\n      return;\n    }\n\n    _notice.addModuleClass('ui-pnotify-desktop-hide');\n    _notice.animation = 'none';\n    genNotice();\n  }\n\n  export function beforeOpen () {\n    if (desktop && !_permission) {\n      requestPermission();\n    }\n    if (_disabled) {\n      return;\n    }\n    if (_desktop && 'show' in _desktop) {\n      _notice.setModuleIsNoticeOpen(true);\n      _desktop.show();\n    }\n  }\n\n  export function beforeClose () {\n    if (_disabled) {\n      return;\n    }\n    if (_desktop && 'close' in _desktop) {\n      _desktop.close();\n      _notice.setModuleIsNoticeOpen(false);\n    }\n  }\n\n  function genNotice () {\n    if (icon === null) {\n      switch (_notice.type) {\n        case 'error':\n          _icon = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3gQJATQg7e6HvQAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAABr0lEQVRYw8WXu0oDQRSGv7hRSFYrLTTWKihaqUgUJO+gphBLL1jYpPSCVcAggpWthYhC7Ows9An0IbSPkMRCw8ZmFuI6yczs9cAPuzNz5v92brtrESxGARtokkCcAg2hk7jNl4G2R/m4zFPAiwTgWdRFHnmJuaulOAAaPQDqUZvv9DB3tR0lwIcGwHtU5uca5q4qYZvngJbHpAZ8CtU8dS1gLEyAisegBGTFKWiL65KnzVlY5uOSId6VtNuTtMupOu/TAHiQlNmSskHNXCOAGWBeUp7VhFoApoMAXAOWJoCszBJ9+ALY6vL0JiPgjsKmKUAaOOoBZwIAcNxlJLsCrAOTIQJMAWu62y4LOIqT7lGS96TIcYCMDkBZ46h1gB+PHI28ssq8X/G6DaqG8Piz2DrjVjGXbtSBy46F5QAHwJAizwZugKKscs7gSaqS/KpB/qxsFxwafhf6Odb/eblJi8BGwJdW26BtURxQpMU83hmaDQsNiPtvYMSwj3tgAqDgYzU7wJdHjo9+CgBvEW47lV5Tgj5DMtG0xIfESkIAF+522gdWxTzGEX3i9+6KpOMXF5UBt0NKJCAAAAAASUVORK5CYII=';\n          break;\n        case 'success':\n          _icon = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3gQJATQPRj+65AAAAdBJREFUWMPtlzsvRFEQx3+7HmEjoiYKolVJJDRqnS8ggvVIVEQhCIUsEYJGCEH2E4h4FPREaLTbEo1IEJXHrmY2GTf33nPuY7ud5OTenTMz//89Z86ZWShLWf5LB3AOfACFiOMF2AkC3qOc88BXxFEAxlX8ftGdaNCEen8H6oFHYBR4FocwkpTngzzHgF01fwL0aYcp9fVtMW/rsMcWXWijK1Hexgye9smRT6CxaHgjytMYwccNSXqoja9FeVbiZS+OVaeDiUBLAPAJA/i2m5MXgRSQk7llC/DBMOBeBGqAe0eAjQhfvurH3EmgQk6EW6CVEHt+ZFo6J4EU8OoTcF35jhnAl2wSx20LFgyB1yyOWtY2c72ScMAAkPeZy6g4zUBdGAIAcyEq4Z7y7xbdTFgCACMBwPVJqVDHeNqvaplkH5i0sNuUwmaNkQxww20ZSOy7gFvX7SAk0i76jPQQlJoAwAEwq35ngfmwVatSdUMArZZ+K9JQ1Bp6iGqgSt7f/AIOqSzujLEn6AV+JG6zm4HuCZ+AJuAbWAQu5aIJu7JDck0ngDugC/j1c2qPqR13jpxuvWyS8liY/kQcean/lX6ACQ99DdAQYe+Lf0zylMUgf7qDKgzv284QAAAAAElFTkSuQmCC';\n          break;\n        case 'info':\n          _icon = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3gQJATQ09zRTwAAAAdxJREFUWMPtl88rRFEUxz8zBolRCgsrpOym8TMSO2WplLKwUrKi/B0W7JSFmhVLNlhSlLKx8CtRGpEsJpofpZk3Nkc9b968e++8mdlw6vTeu/edc773nl/3wl+ngOH/zUAf0AN0AmEgB7wCD8AtcFMJoM3ADpAHLHk62RIwL8B0uQwHgXVRnDfkS2DSj/EW4K0Ew05eLMV4O/CuUJwEUvJUgdgwMd4IpBUKl13kVG6aL+ZjJ20DDQqQXy5jKYVMDBhVrb5f069LLrKfGnInqh040HRTvsTAHgei9oGQ7X0YaNNUNCdFKChgQvKtQ1vAkNvEahlSToez9oXad2BCA30ceHZxRxMQMShuvZLmv+hOA32/h+KUwS7MugVhqwb6Go+5nEEwht0ABDUEzyXdFsrQYwqMJjTbdxio9Qkg6QbgvkpnkLw0uQIAZ1UCYNkXawdw4qPCmVBcuADAMZCpAoCVYr3AKtYyHZSWauakjMx50TWwrzJw6lFARjQOt3se8jM6W9TloSCqIb9bRHbN5Fg+KkEZcow/Ak+KFBsD6h3jR8CUabAMlqn7xfxEbAdwWKLhhO3sGPCbOsNSvSyF0Z/5TaCuEleziLhmAOiWG1NWrmZXwIVU1A/+SZO+AcgLC4wt0zD3AAAAAElFTkSuQmCC';\n          break;\n        case 'notice':\n        default:\n          _icon = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3gQJATM4scOJLAAAAcxJREFUWMPtljtLA0EQx3+J0QRfnYqCiCA+MERBrIwgFtoFbMTOR61i5QcQBdEihZWNoEWwsNAvkMJeBLHRQtHC0iIP4utOmw2cx97d7l2SRgcGbufmv/Pf2dmdhb8uIR+YJqAPaBff30AeeAHuxLgqMgRkgS/AAEybGuLfEdBcycCTwKVYmY5mgO6gwdd8BLaqAST9Bs8EDG7VTd3gex4TbgEjwKjQOHDugZlRDb7sMZEJpCS4bYVMJOygsG1cB+wqHN0Gib1RYXFpLwL74nx7Sb3EFlXATQNjTgRagA3FbZIRiCliT5wITGgUaRACA0CPjMC4xtUcDUAgDAzLCCQ0MhALQCAE9MoIdGkQCJIBgE4ZgWiNMvDL10qgUMMMFGQEnjQmkLXbVg38s8y4qtFcTCAnHiJ5oKiJnSoHjVgIXAmHkGIl5yy+YcWruIy9dvqpupIDCfZWEXvh1gsWFVfxIbG9a3RbRwJnYiuqJYfAqxsBgBWFiQyJzfTAlIB1uzEicbwBFoBTl8lSwINoSuXKjrv4F4FBh61zlKUKvgn7/e5ZEngMEDgLdFSieHaAT42LpgTMVbqC24B54Bi4twV9E6cnDcw6PFj+RSo/l6rlSlldhx4AAAAASUVORK5CYII=';\n          break;\n      }\n    } else if (icon === false) {\n      _icon = null;\n    } else {\n      _icon = icon;\n    }\n\n    if (!_tag || tag !== null) {\n      _tag = tag === null ? 'PNotify-' + Math.round(Math.random() * 1000000) : tag;\n    }\n\n    const desktopOptions = {\n      body: text || _notice.text,\n      tag: _tag\n    };\n    if (!_notice.hide) {\n      desktopOptions.requireInteraction = true;\n    }\n    if (_icon !== null) {\n      desktopOptions.icon = _icon;\n    }\n    Object.apply(desktopOptions, options);\n\n    _desktop = notify(\n      title || _notice.title,\n      desktopOptions,\n      () => {\n        _notice.fire && _notice.fire('click', { target: _desktop });\n      },\n      () => {\n        _notice.close && _notice.close();\n      }\n    );\n\n    if (!('close' in _desktop) && ('cancel' in _desktop)) {\n      _desktop.close = () => {\n        _desktop.cancel();\n      };\n    }\n  }\n</script>\n<style>\n  :global([ui-pnotify].ui-pnotify-desktop-hide) {\n    left: -10000px !important;\n    display: none !important;\n  }\n</style>\n"],"mappings":"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"}